function pageinit(n){Compressor.setDefaults({quality:.8,width:150,height:150,maxWidth:150,maxHeight:150,resize:"cover"}),$(".edit-btn").click(function(){var e=$(this).closest(".member-edit-form");e.find(".hidden-input").fadeIn(),e.find(":text").prop("disabled",!1),e.find(".edit-btn,.mdf-btns").toggle()});let s=$("#profilePreview");$("[name=picFile]").on("change",function(e){let t=e.target.files[0];if(null==t)return!1;let a=new FileReader;a.onload=function(){s.css("background-image","url("+this.result+")"),URL.revokeObjectURL(a.result)},new Compressor(t,{success(e){a.readAsDataURL(e)},error(){a.readAsDataURL(t)}}),$(this).closest("form").find(".mdf-btns").show()}),$(".js-edit-cancel").click(function(){var e,t=$(this).closest(".member-edit-form");0<t.find("#profilePreview").length?s.css("background-image",s.data("orgdata")):(e=t.find("[data-orgdata]")).val(e.data("orgdata")),t.removeClass("was-validated"),t.find(".hidden-input").fadeOut(),t.find(":text").prop("disabled",!0),t.find(".edit-btn,.mdf-btns").toggle()}),$("#passwd, #passwdCheck").on("input",function(){this.closest("form").matches("was-validated")&&$("#passwdCheck").toggleClass("is-invalid",$("#passwd").val()!=$("#passwdCheck").val())}),$(".member-edit-form").on("submit",function(e){if(e.preventDefault(),!this.checkValidity())return!0;if(this.querySelector("#passwdCheck")&&($("#passwdCheck").toggleClass("is-invalid",$("#passwd").val()!=$("#passwdCheck").val()),$("#passwdCheck").is(".is-invalid")))return!0;let a=this,t=new FormData(a);function s(e){alert("수정되었습니다.");var t=$(a).find("[data-orgdata]");t.is("img")?($(".personacon .image-section img").css("background-image",t.css("background-image")),t.data("orgdata",t.css("background-image"))):(t.is("[name=alias]")&&$(".personacon .alias").text(e),t.data("orgdata",t.val())),$(a).find(".hidden-input").fadeOut(),$(a).find(":text").prop("disabled",!0),$(a).find(".edit-btn,.mdf-btns").toggle()}function i(e){0<$(a).find("[name=passwd]").length&&403==e.status?alert("기존 비밀번호가 틀렸습니다."):alert("수정 중 오류가 발생했습니다.")}t.append("memberId",n),null!=a.querySelector("input[name=picFile]")?(e=a.querySelector("input[name=picFile]").files[0],new Compressor(e,{success(e){t.delete("picFile"),t.append("picFile",e,e.name),postForm(a.action,t,s,i)},error(){postForm(a.action,t,s,i)}})):postForm(a.action,t,s,i)}),$(".js-delete-member").on("click",function(){confirmModal('<p>보안을 위해 비밀번호를 한 번 더 입력해 주세요.</p><input type="password" id="js-verify-passwd" class="form-control mx-auto" placeholder="비밀번호" maxlength="16" autocomplete="password" style="width:calc(16ch + .75rem)">',function(){let e=$("#js-verify-passwd").val();e?confirmModal('탈퇴 시, 지금까지 저장된 <b class="text-danger">영어 지문과 문장 기록이 모두 삭제</b>됩니다.<br>혹시 잠시 쉬고 싶으신 거라면, 계정을 그대로 두셔도 괜찮습니다.<br>그래도 탈퇴를 진행하시겠습니까?',function(){$.ajax({url:"/member/delete",type:"POST",contentType:"application/json",data:e,success:()=>{alertModal("탈퇴가 완료되었습니다. 이용해 주셔서 감사합니다.",()=>location.assign("/"))},error:e=>{e.status?alertModal(e.responseText):alertModal("알 수 없는 오류가 발생했습니다.")}})}):alertModal("비밀번호가 입력되지 않았습니다.")})})}function postForm(e,t,a,s){$.ajax({url:e,type:"POST",data:t,processData:!1,contentType:!1,success:a,error:s})}