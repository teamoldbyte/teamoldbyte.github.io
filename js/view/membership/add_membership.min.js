function pageinit(a){let o=0!=a.mid,l=[];$(".membership-item-list-section .toggle-block").on("click",".monthly,.yearly",function(){$(this).is(".monthly.is-monthly,.yearly.is-yearly")||($(this).siblings().add(this).add(".membership-item-list-section .membership-item-block").toggleClass("is-monthly is-yearly"),$(".membership-item-block.gold-membership .price-block").toggle())}),$(".membership-item-block.gold-membership .toggle-block").on("click",".monthly,.yearly",function(){var e=$(this).is(".monthly"),i=$(this).closest(".membership-item-block");i.find(".toggle-block").find(".monthly,.yearly").toggleClass("is-monthly",e).toggleClass("is-yearly",!e),i.find(".price-block.monthly").toggle(e),i.find(".price-block.yearly").toggle(!e),i.find(".iid").val(this.dataset.iid),i.find(".item-full-name").val(this.dataset.itemName),i.find(".item-real-price").val(this.dataset.price)}),$(document).on("show.bs.modal","#done-info-modal",function(e){var e=e.relatedTarget,e=$(e).closest(".membership-item-block").find(".price-block:visible"),i=e.find(".iid").val(),t=e.find(".item-full-name").val(),e=e.find(".item-real-price").val();l=[i],$(this).find(".btn-close").show(),$("#totalAmount").val(e.replace(/\D/g,"")),$("#orderName").val(t),$("#phase-1 form").toggleClass("was-validated",o),$("#passwd,#passwdCheck").prop("required",!o).prop("readonly",o),o&&($(".check-email-btn").prop("disabled",!0),$("#inputName").val("fico"!=a.remitter?a.remitter:""),$("#inputPhone").val(a.phone),$("#inputEmail,.check-email-input").val(a.email),$("#inputEmail").prop("readonly",o),Array.from(["mid","phone","remitter","memberRoleName"],e=>{$("#"+e).val(a[e??""])}),$(`[name="sex"][value="${a.sex}"]`).prop("checked",!0),$(`.input-birth option[value="${a.birthYear}"]`).prop("selected",!0),$("#phase-1 form :submit").prop("disabled",!$("#membershipForm")[0].checkValidity()),"fico"!=a.remitter)&&$("#phase-1 form :submit").trigger("click")}).on("hide.bs.modal","#done-info-modal",function(e){clearTimeout(void 0),$("#phase-1 form").removeClass("was-validated"),FicoPaymentHandler?.destroy(),o||$("#phase-1 form")[0].reset(),$("#inputEmail").trigger("input"),$("#donationModalLabel").text("회원 정보 입력"),$("#phase-2 [data-bs-toggle=collapse]").prop("disabled",!0),$("#phase-2,#phase-3").collapse("hide"),$("#phase-1").collapse("show")}),$(document).on("click","#closeDonation",function(){confirmModal("가입 진행을 취소하시겠습니까?\n진행 중이던 정보는 저장되지 않습니다.",()=>$("#done-info-modal").modal("hide"))}).on("show.bs.collapse","#phase-1",function(){$("#done-info-modal .btn-close").show()}).on("input","#inputEmail",function(){this.value!=$(".check-email-input").val()&&$(".check-email-input").val(""),$(".check-email-btn").prop("disabled",!this.checkValidity())}).on("click",".check-email-btn",function(){let i=$("#inputEmail").val();$.getJSON("/membership/email/check",{email:i},e=>{$(".check-email-input").val(e?"":i).trigger("input"),$("#paymentForm").addClass("was-validated"),e?$(".check-modal-section").modal("show"):alertModal("사용가능한 E-mail입니다. 가입 진행을 계속해 주세요.")})}).on("input","#phase-1 input",function(){var e=this.form,i=e.querySelector('[type="submit"]');Array.from(e.querySelectorAll("input")).every(e=>e.checkValidity())?(i.toggleAttribute("disabled",!1),$(i).bounce()):i.toggleAttribute("disabled",!0)}).on("input","#inputName",function(){$(this).toggleClass("is-invalid","fico"==this.value.trim()),"fico"==this.value.trim()&&alertModal("사용할 수 없는 이름입니다.")}).on("submit","#phase-1 form",function(e){e.preventDefault();let i=e.originalEvent.submitter;this.querySelector('[name="remitter"]').value=this.querySelector('[name="name"]').value=$("#inputName").val().trim(),this.querySelector("[name=email]").value=$("#inputEmail").val().trim(),this.querySelector("[name=phone]").value=$("#inputPhone").val().trim();e=Object.fromEntries(new FormData(this).entries());this.checkValidity()&&(i.disabled=!0,$("#order-processing").show(),$("#payment-methods, #phase-2 :submit").hide(),$("#phase-1,#phase-2").collapse("toggle"),e.orderItemList=l,$.ajax({url:"/membership/order",type:"POST",data:JSON.stringify(e),contentType:"application/json",success:async({memberId56:e,orderId56:i})=>{await FicoPaymentHandler.renderWidget("#payment-methods",{orderId:i,orderName:$("#orderName").val(),amount:parseInt($("#totalAmount").val()),customerKey:e,customerName:$("#inputName").val(),customerEmail:$("#inputEmail").val(),customerMobilePhone:$("#phone").val()}),$("#order-processing").hide(),$("#payment-methods, #phase-2 :submit").show()},error:()=>{alertModal("가입 처리 중 오류가 발생하였습니다.\nteamoldbyte@gmail.com 로 문의 바랍니다.",()=>$("#done-info-moal").modal("hide"))},complete:()=>i.disabled=!1}))}).on("click","#phase-2 :submit",function(){FicoPaymentHandler.requestPayment()}).on("show.bs.collapse","#phase-2",function(){$("#donationModalLabel").text("결제")}).on("input","#passwd,#passwdCheck",function(){this.closest("form").matches(".was-validated")&&$("#passwdCheck").toggleClass("is-invalid",$("#passwd").val()!=$("#passwdCheck").val())}),$.get("https://static.findsvoc.com/fragment/membership/incl/order_modal.html",e=>{e=$("<div>").append(e);let t=e.find(".input-birth select");var i=(new Date).getFullYear();let a=i-14;i=a-(i-101)+1;Array.from({length:i},(e,i)=>{t.append(`<option value="${a-i}">${a-i}</option>`)}),t.find("option[disabled]").prop("selected",!0),$(".membership-section").append(e.find("#done-info-modal")),$(".tandem-layout-content-section").append(e.find("#check-modal"))},"html")}