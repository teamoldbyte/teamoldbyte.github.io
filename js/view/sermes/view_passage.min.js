async function pageinit(I,f,h,M,C,m,E,g,S){const s=parseFloat(getComputedStyle(document.documentElement).fontSize),V=new FicoTTS({initSuccessCallback:()=>{devSize.isPhone()||document.querySelector("#ttsSettings .form-switch").remove()}}),T=await $.get("https://static.findsvoc.com/fragment/workbook/element_templates.min.html",jQuery.noop,"html"),j={"n.":"ëª…ì‚¬","v.":"ë™ì‚¬","vt.":"íƒ€ë™ì‚¬","vi.":"ìë™ì‚¬","a.":"í˜•ìš©ì‚¬","ad.":"ë¶€ì‚¬","prep.":"ì „ì¹˜ì‚¬","conj.":"ì ‘ì†ì‚¬","int.":"ê°íƒ„ì‚¬","abbr.":"ì•½ì–´","pron.":"ëŒ€ëª…ì‚¬","NP.":"ëª…ì‚¬êµ¬","phrasal-v.":"êµ¬ë™ì‚¬","VP.":"ë™ì‚¬êµ¬","PP.":"ì „ì¹˜ì‚¬êµ¬","ADP.":"ë¶€ì‚¬êµ¬","AJP.":"í˜•ìš©ì‚¬êµ¬","IP.":"ê´€ìš©ì–´","CP.":"ì—°ì–´"};$(window).on("unload",()=>$("#loadingModal").modal("hide")),$(".workbook-menu-section").find(".logo-link-section").addClass("glass-effect"),/Mobi/.test(navigator?.userAgent)&&screen.orientation||$(".js-rotate-btn").remove();JSON.parse(sessionStorage.getItem("passageIdList"));$(".sentence-link").one("click",function e(){$(".sentence-link").off("click",e).not(this).addClass("pe-none opacity-50");const t=$(this).index(".sentence-link");var n=S[t],s=$(".one-sentence-unit-section:eq(0)"),o=(s.data("sentenceId",n.sentenceId).attr("id","sentence"+(t+1)).data("metaEvaluated",["S","F"].includes(n.metaStatus)).find(".origin-sentence-section"),s.find(".removable-section").collapse("show"),s.find(".collapse-btn").each(function(){this.dataset.bsTarget=`#sentence${t+1} `+this.dataset.collapseSelector}),s.find(".origin-sentence").append($(T).children(".origin-sentence-container").clone(!0).children()).find(".sentence-text").text(n.text),s.find(".numbering-text").remove(),n.text),a=n.svocList;s.find(".result-semantic-section").append($(T).children(".svoc-menu-section").clone(!0)).find(".js-open-dashboard").attr("data-bs-target",`#sentence${t+1} .dashboard-section`);let i=a[0];const l=$(T).children(".svoc-section").clone(!0);l.appendTo(s.find(".result-semantic-section")),tandem.showSemanticAnalysis(o,i.svocBytes,l.find(".svoc-block")).then(e=>{l.find(".writer-section").empty().append($("#hiddenDivs").find(".help-icon,.tip-icon,.js-rotate-btn").clone());var t=l.find(".svoc-mdf-btns");t.find("[data-seq]").attr("data-seq",e.dataset.seq),I!=i.memberId&&t.remove()});var a=L(n.metaStatus),d=(s.find(".dashboard-section .meta-status").text(a.icon).attr("title",a.msg),n.korList);if(null!=d&&0<d.length){var c=d.length,r=s.find(".ai-translation-section").show().empty();for(let e=0;e<c;e++){var p=O.clone(),f=d[e];p.data("korTid",f.korId),"Translator"!=f.alias?p.addClass("user-trans").find(".translator").text(" "+f.alias):p.addClass("ai-trans"),p.find(".translation-text").text(f.kor),I==f.memberId&&p.append($(T).find(".trans-mdf-btns").clone(!0)),r.append(p)}r.closest(".translation-section").find(".open-kor-btn").addClass("active"),r.find(".ai-translation-block").collapse("show")}var h=n.wordList;if(null!=h&&0<h.length){var m=h.length,g=s.find(".collapse-section .word-section, .sentence-ext-section .word-section .one-block").empty();g.closest(".word-list-section").toggleClass("has-user-vocas",h.some(e=>e.senseList.some(e=>/[A-Z]|phrasal-v/.test(e.partType))));for(let e=0;e<m;e++){const y=h[e],x=P.clone();x.toggleClass("user-vocas-word",y.senseList.some(e=>/[A-Z]|phrasal-v/.test(e.partType))),x.data({wordId:y.wid,sentenceId:n.sentenceId,workbookId:C,sentenceWordId:y.sentenceWordId}),x.find(".one-part-unit-section").remove(),x.find(".title").text(y.title).attr("data-playing","off").click(function(e){e.stopPropagation(),"on"==this.dataset.playing?N():(N(this),this.dataset.playing="on",this.classList.add("tts-playing","blink-2"),V.speakRepeat(y.title,2,500,()=>{this.classList.remove("tts-playing","blink-2"),this.dataset.playing="off"}))});var u=y.senseList;if(null!=u){var v=u.length;for(let e=0;e<v;e++){var b=u[e],w=q.clone();x.append(w),w.find(".part").text(b.partType).attr("title",j[b.partType]),w.find(".meaning").text(b.meaning)}g.append(x)}}devSize.isPhone()||s.find('.nav-link[data-type="word-list"]').tab("show")}let k=s.find(".related-list").addClass("loading position-relative show");k.append('<i class="loading-icon w-auto offset-6 text-center fa-2x fas fa-spin fa-circle-notch text-fc-purple"></i>'),k.find(".empty-list").hide();o=s.data("sentenceId");$.getJSON("/workbook/search/finger/"+ntoa(o),t=>{if(null!=t&&0<t.length){k.empty();var n=t.length;for(let e=0;e<n;e++){var s=t[e],o=$(T).find(".finger-section").clone(!0);["A","S"].includes(M)||o.find(".svoc-mdf-btns").remove(),k.append(o),o.data("sentenceId",s.sentenceId).find(".sentence-text").text(s.eng)}}else k.find(".empty-list").show(),k.find(".loading-icon").remove();k.removeClass("loading").addClass("loaded")}).fail(()=>{alertModal("ì¸ë±ìŠ¤ í•‘ê±° ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."),k.find(".empty-list").show(),k.find(".loading-icon").remove(),k.removeClass("loading").addClass("loaded")}),setTimeout(()=>$(".result-section")[0].scrollIntoView(),500)}),$("#passageNotes, #passageQnas").on("show.bs.collapse",function(e){$(e.target).is(".qna-section,.note-section")&&($(this).siblings(".collapse").collapse("hide"),$(this).closest(".passage-comment-section").addClass("bg-fc-light-purple"))}).on("hide.bs.collapse",function(e){$(e.target).is(".qna-section,.note-section")&&0==$(this).siblings(".collapse.show").length&&$(this).closest(".passage-comment-section").removeClass("bg-fc-light-purple")}),$("#passageNotes,#passageNotes_mobile").one("show.bs.collapse",function(){const t=$(this);t.is(".loading")||(t.addClass("loading"),$.getJSON(`/workbook/passage/note/list/${C}/${g}/`+I,e=>{var n=e,s=t.find(".note-list").empty();0<n.length&&s.siblings(".empty-list").hide();for(let e=0,t=n.length;e<t;e++)k(n[e]).appendTo(s);t.removeClass("loading")}).fail(()=>alertModal("ë…¸íŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì ‘ì†í•´ ì£¼ì„¸ìš”.")))}),$("#passageQnas").one("show.bs.collapse",function(){const e=$(this);e.is(".loading")||(e.addClass("loading"),$.getJSON(["/qnastack/question/workbook/passage",C,g].join("/"),function(n){0<n.length&&e.find(".empty-list").hide();var s=e.find(".qna-list").empty();for(let e=0,t=n.length;e<t;e++){var o=n[e],o=createQuestionDOM(o,!1);o.find(".accordion-collapse").attr("data-bs-parent","#passageQnas .qna-list"),s.append(o)}e.removeClass("loading")}).fail(()=>alertModal("ì§ˆë¬¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì ‘ì†í•´ ì£¼ì„¸ìš”.")))});let t=$(".result-section");var e=$(".one-sentence-unit-section").clone();let O=e.find(".ai-translation-block:eq(0)"),P=e.find(".one-word-unit-section:eq(0)"),q=e.find(".one-part-unit-section:eq(0)"),n=(0==S.length&&$("#loadingModal").modal("hide"),$(document).one("click",".origin-sentence-section",function(e){}),0),o=$(".view-passage-section")[0].scrollTop;const a=$(".workbook-menu-section");$(document).on("scroll",function(){var e=scrollY>o?1:-1;o=scrollY,n==e||$("#js-mobile-menu .passage-sentence-nav").is(".show")||(n=e,anime({targets:"#js-mobile-menu",easing:"linear",duration:200,translateY:0<e?"100%":0}))});let i,l,d;function c(e,t){t=t.match(/swiper[-\w]*/g);return $(this).data("swiperClass",t),t}function r(t){var e=t.closest(".one-sentence-unit-section").data("sentenceId");!t.is(".loading,.loaded")&&e&&(t.addClass("loading").find(".empty-list").show(),$.getJSON(`/workbook/sentence/note/list/${C}/${e}/`+I,e=>{var n=e,s=(0<n.length&&t.find(".empty-list").hide(),t.find(".note-list").empty());for(let e=0,t=n.length;e<t;e++)k(n[e]).appendTo(s);t.toggleClass("loading loaded")}).fail(()=>alertModal("ë…¸íŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì ‘ì†í•´ ì£¼ì„¸ìš”.")))}function N(t){V.stop(),document.querySelectorAll('[class*="js-tts-play"][data-playing="on"],.tts-playing').forEach(e=>{t!=e&&(e.matches('[class*="js-tts-play"]')?e.textContent="play_circle":e.matches(".tts-playing")&&e.classList.remove("tts-playing","blink-2"),e.dataset.playing="off")})}$(window).on("resize",function(){devSize.isPhone()?($(".one-sentence-unit-section").addClass(function(){return["swiper-slide"].concat($(this).data("swiperClass"))}).parent(".result-section").addClass(function(){return["swiper-wrapper"].concat($(this).data("swiperClass"))}).parent().addClass(function(){return["swiper"].concat($(this).data("swiperClass"))}),d?(d.enable(),d.slides.forEach(e=>l.observe(e))):d=new Swiper(".swiper",{breakpoints:{576:{enabled:!1}},autoHeight:!0,speed:250,navigation:{prevEl:".js-prev-sentence",nextEl:".js-next-sentence"},pagination:{el:".swiper-pagination",clickable:!0},spaceBetween:30,on:{afterInit:function(t){(i=new IntersectionObserver(e=>{anime({targets:a.get(0),duration:150,easing:"linear",translateY:0<e[0].intersectionRatio?0:"-7rem"})},{rootMargin:`-${7*s}px 0px ${0*s}px 0px`})).observe($(".workbook-cover-section").get(0)),l=new ResizeObserver(e=>{e.find(e=>e.target==t.slides[t.activeIndex])&&t.update()}),t.slides.forEach(e=>l.observe(e));var e=t.slides[0],e=$(e).find(".collapse-section .note-section");function n(){setTimeout(()=>{$(".js-tts-play-sentence").trigger("click")},500)}e.collapse("show"),r(e),$(".passage-sentence-nav .sentence").eq(this.activeIndex).addClass("active"),devSize.isPhone()&&V.autoEnabled()&&($("#loadingModal").is(".show")?$("#loadingModal").on("hidden.bs.modal",n):n())},slideChange:function(){$(this.slides[this.activeIndex]).find(".note-section").collapse("show"),$(".passage-sentence-nav .sentence").eq(this.activeIndex).addClass("active").siblings(".sentence").removeClass("active"),N()},slideChangeTransitionEnd:function(e){scrollTo(0,t[0].offsetTop),localStorage.getItem("fico-swipe-happened")||localStorage.setItem("fico-swipe-happened",!0),setTimeout(()=>{$(e.slides[e.activeIndex]).find(".semantics-result:visible").each(function(){tandem.correctMarkLine(this)}),V.autoEnabled()&&$(".js-tts-play-sentence").trigger("click")},500)}}})):(l?.disconnect(),d?.disable(),$(".one-sentence-unit-section").removeClass(c).parent(".result-section").removeClass(c).attr("style","").parent().removeClass(c))}).trigger("resize"),$(document).one("click","#js-mobile-menu .sentence-link",function(){$("#js-mobile-menu .mobile-menu-section,#js-mobile-menu .passage-sentence-nav").collapse("toggle"),d.slideTo($(this).index())}).on("show.bs.collapse hide.bs.collapse","#js-mobile-menu .passage-sentence-nav",function(e){e.target==this&&($("#js-mobile-menu .js-toggle-menu").animate("show"==e.type?{rotate:"180deg"}:{rotate:"0deg"}),$("#js-mobile-menu").css("transform","translateY(0)"),"show"==e.type)&&$(".passage-sentence-nav .sentence.active")[0].scrollIntoView()}).on("show.bs.collapse",".collapse-section .note-section",function(){r($(this))}).on("click",".word-list-section",function(){var e;devSize.isPhone()&&(e=$(this).find(".word-section"),this.matches(".shrink")?(e.animate({height:e.data("orgHeight")+"px"}),this.classList.remove("shrink")):(this.classList.add("shrink"),e.data("orgHeight")||e.data("orgHeight",e.height()),e.animate({height:"1.5rem"},300)))}).on("click",".note-list .note-text",function(){devSize.isPhone()&&(this.matches(".shrink")?($(this).animate({height:$(this).data("orgHeight")+"px"}),this.classList.remove("shrink")):(this.classList.add("shrink"),$(this).data("orgHeight")||$(this).data("orgHeight",$(this).height()),$(this).animate({height:"1.5rem"},300)))}),devSize.isPhone()&&!localStorage.getItem("fico-swipe-happened")&&$("#loadingModal").on("hidden.bs.modal",function(){setTimeout(()=>{$(".swipe-intro").show(),setTimeout(()=>$(".swipe-intro").remove(),2e3)},1e3)}),$(document).on("click","#toggle-all-btn",function(){var e=$(this).find(".fold-icon").is(".expanded")?"hide":"show";$(".one-sentence-unit-section>.collapse").trigger("prv.scroll").collapse(e),$(this).find(".fold-icon").toggleClass("expanded")}).on("prv.scroll",".one-sentence-unit-section>.collapse",function(){this.dataset.scroll="false"}).on("show.bs.collapse hide.bs.collapse",".one-sentence-unit-section>.collapse",function(e){var t;e.target==e.currentTarget&&((t=$(this).closest(".one-sentence-unit-section")).toggleClass("active","show"==e.type).find(".origin-sentence-section").attr("aria-expanded","show"==e.type),"show"==e.type&&"false"!=e.target.dataset.scroll&&t[0].scrollIntoView(),e.target.dataset.scroll="true")}).on("click",".js-tts-play-all, .js-tts-play-sentence",function(e){e.stopPropagation();const n=this;if("on"==n.dataset.playing)N();else if(N(n),n.dataset.playing="on",n.textContent="stop_circle",n.matches(".js-tts-play-all")){const s=$(".full-text .sentence-link").get();let t;!function e(){t&&t.classList.remove("tts-playing","blink-2");if("off"==n.dataset.playing)return;0<s.length?setTimeout(()=>{(t=s.shift()).classList.add("tts-playing","blink-2"),V.speak(t.textContent,e)},0):(n.dataset.playing="off",n.textContent="play_circle")}()}else{let e=$(n).closest(".origin-sentence").find(".sentence-text:visible")[0]||d.slides[d.activeIndex]?.querySelector(".sentence-text");e&&(e.classList.add("tts-playing"),V.speakRepeat(e.textContent,2,500,()=>{e.classList.remove("tts-playing"),n.dataset.playing="off",n.textContent="play_circle"}))}}).on("click",".js-tts-setting",function(e){e.stopPropagation(),N(),V.openSettings()}),$(document).on("shown.bs.collapse",".one-sentence-unit-section>.collapse",function(e){if(e.target.matches(".removable-section")&&e.target==e.currentTarget){var t=$(this).closest(".one-sentence-unit-section"),n=t.data("sentenceId");$(e.target).find(".semantics-result").filter(":visible").each(function(){tandem.correctMarkLine(this)}),t.data("metaEvaluated")||$(e.target).find(".dashboard-section").collapse("show");const o=t.find(".sentence-ext-section .note-section");o.is(".loading,.loaded")||(o.addClass("loading"),o.find(".empty-list").show(),$.getJSON(`/workbook/sentence/note/list/${C}/${n}/`+I,e=>{var n=e,s=(0<n.length&&o.find(".empty-list").hide(),o.find(".note-list").empty());for(let e=0,t=n.length;e<t;e++)k(n[e]).appendTo(s);o.toggleClass("loading loaded")}).fail(()=>alertModal("ë…¸íŠ¸ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì ‘ì†í•´ ì£¼ì„¸ìš”.")))}}).on("shown.bs.collapse",".svoc-section",function(){tandem.correctMarkLine(this.querySelector(".semantics-result"))}),$(document).on("show.bs.collapse",".dashboard-section",function(){$(this).prev(".result-semantic-section").addClass("border-bottom-0"),$(this).find(".tip-content-section").hide(0,function(){var e=$(this).closest(".one-sentence-unit-section").find(".origin-sentence .sentence-text").text();$(this).html(tandem?.tip?.showRandomTip(e.match(/['"]/)?5:void 0)).fadeIn()})}).on("shown.bs.collapse",".dashboard-section",function(){devSize.isPhone()&&scrollTo(scrollX,$(this).offset().top-visualViewport.height/2+this.offsetHeight/2)}).on("hidden.bs.collapse",".dashboard-section",function(){$(this).prev(".result-semantic-section").removeClass("border-bottom-0")}),$(document).on("click","div:not(.edit-svoc)>.semantics-result,.js-collapse-svoc",function(){var e=$(this).closest(".one-sentence-unit-section");e.find(".result-semantic-section .collapse").collapse("toggle"),e.find(".js-collapse-svoc").toggleClass("expanded")});const p={S:"<b>í‰ê°€ë¥¼ í•˜ëŠ” ì´ìœ </b><br><br>A.I.ëŠ” ì¸ê°„ì˜ ì–¸ì–´ë¥¼ ì´í•´í•˜ë©´ì„œ ë¶„ì„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>í•™ìŠµìë“¤ì—ê²Œ ë„ì›€ì´ ë  ìˆ˜ ìˆë„ë¡ ë¶„ì„ ê²°ê³¼ë¥¼ í‰ê°€í•´ì£¼ì„¸ìš”.<br>í‰ê°€ë„ í•˜ê³  ë‹¤ì–‘í•œ fico Eggë„ ëª¨ì•„ë³´ì„¸ìš”.",F:"<b>AI ë¶„ì„ì´ ì •í™•í•˜ì§€ ì•Šì€ê°€ìš”?</b><br><br>ê·¸ê±´ íšŒì›ë‹˜ì´ AIë³´ë‹¤ ì‹¤ë ¥ì´ ì¢‹ë‹¤ëŠ” ì¦ê±°ì…ë‹ˆë‹¤.<br>ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ë„ ìˆê³  ê·¸ëƒ¥ ë‚´ë²„ë ¤ ë‘˜ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.<br>ì‹¤ë ¥ ë°œíœ˜ ê¸°ëŒ€í•©ë‹ˆë‹¤."};function u(t,n){let s=!1;t.closest(".dashboard-section").find(".edit-meta-status-btn[data-meta-status]").each(function(){var e;this.disabled||(e=$(this).prop("disabled",!0).wrap('<span data-bs-original-title="ì´ë¯¸ í‰ê°€í•œ ë¬¸ì¥ì…ë‹ˆë‹¤."></span>').parent()[0],new bootstrap.Tooltip(e,{trigger:"hover focus"}).enable(),e.querySelector(".material-icons").className="material-icons text-gray-400")});const e=t.next();e.popover("show"),setTimeout(()=>e.popover("dispose"),3e3),anime({targets:t[0],rotateX:360,scale:[{value:3,duration:500,easing:"easeOutBack"},{value:1,duration:2500,easing:"easeInBounce"}],delay:300,duration:3e3,update:function(e){!s&&20<e.progress&&(t.text(n.icon).attr({title:n.msg,dataBsOriginalTitle:n.msg}),s=!0)},complete:function(){t[0].style.transform=""}})}$("#check-modal").on("show.bs.modal",function(e){var e=e.relatedTarget,t=this.querySelector(".status-submit"),n=e.dataset.metaStatus;t.dataset.metaStatus=n,this.querySelector(".modal-body").innerHTML=p[n],$(t).data("sentenceSection",$(e.closest(".one-sentence-unit-section")))}),$("#check-modal .status-submit").on("click",function(){var e=$(this).data("sentenceSection");const t=this.dataset.metaStatus,n=e.find(".dashboard-section .meta-status");tandem?.meta?.submitMetaStatus(e.data("sentenceId"),t,"workbook",()=>{u(n,L(t))}),$("#check-modal").modal("hide")});const v=[],b=($(document).on("click",".js-add-svoc, .js-edit-svoc",async function(){const e=this;let t=$(this).is(".js-add-svoc");const n=!!this.closest(".js-finger-detail"),s=parseInt((n?$(this).closest(".js-finger-detail"):$(this).closest(".one-sentence-unit-section")).data("sentenceId")),o=($(".js-add-svoc").prop("disabled",!0),$(this).closest(".one-sentence-unit-section"));let a=null;var i,l,d;function c(e){t&&null!=e&&(a.closest(".new-svoc-form").removeClass("new-svoc-form"),a.data("svocId",e),o.find(".js-collapse-svoc").addClass("expanded").show(),a.closest(".svoc-section").nextAll(".svoc-section").collapse("show")),a.closest(".svoc-section").find(".svoc-mdf-btns").show(),p(),window.tandem?.meta?.saveGramMetaFromDOM(s,a[0],!0,"workbook"),n||u(a.closest(".one-sentence-unit-section").find(".meta-status"),L("S"))}function r(){v.push(e),p(),alertModal("ì´ ë¬¸ì¥ì˜ êµ¬ë¶„ë¶„ì„ì„\në“±ë¡/ìˆ˜ì •í•  ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.\nì €ì¥ëœ ë¶„ì„ì„ ì§€ìš°ê³  ì—ë””í„°ë¥¼ ë‹«ìŠµë‹ˆë‹¤.")}function p(){$(".js-add-svoc").each(function(){const t=this;$(this).prop("disabled",v.some(e=>e===t))})}t&&!n?((i=$(T).children(".svoc-section").clone(!0).addClass("new-svoc-form")).find(".personacon-alias").text(f),l=$("#hiddenDivs .member-personacon").clone(!0),h&&(l.find(".personacon-profile").removeClass("profile-default")[0].style.background="url(/resource/profile/images/"+h+") center/cover no-repeat"),i.find(".writer-section").attr("data-bs-target",o.find(".writer-section").get(0).dataset.bsTarget).prepend(l),l=o.find(".origin-sentence .sentence-text").text(),d=await tandem.getSvocBytes(o.find(".semantics-result").get(0)),devSize.isPhone()?o.find(".svoc-menu-section").after(i):o.find(".result-semantic-section").prepend(i),(a=$(await tandem.showSemanticAnalysis(l,d,i.find(".svoc-block")))).data("memberId",I),i.find(".svoc-mdf-btns").hide().find("[data-seq]").attr("data-seq",a.attr("data-seq"))):(a=$(this).closest(".svoc-section").find(".semantics-result"),$(this).closest(".svoc-mdf-btns").hide()),a.svoceditor(t,function(e){var t=Number(a.data("svocId")||0),e={sentenceId:s,workbookId:C,passageId:g,ownerId:m,memberId:I,encSvocText:e};I==Number(a.data("memberId"))&&0<t&&(e.svocId=t);return editSvoc(e,c,r)},function(){p(),t?a.closest(".new-svoc-form").remove():a.closest(".svoc-section").find(".svoc-mdf-btns").show()}),setTimeout(()=>{tandem.correctMarkLine(a[0])},500)}).on("click",".js-del-svoc",function(){const e=$('.semantics-result[data-seq="'+this.dataset.seq+'"]'),t=e.closest(".one-sentence-unit-section"),n=Number(e.data("svocId"));function s(){e.closest(".svoc-section").fadeOut(()=>{e.closest(".svoc-section").remove(),t.find(".svoc-section").length<2&&t.find(".js-collapse-svoc").hide(),t.find(".svoc-section").first().removeClass("collapse show"),t.find(".svoc-section").slice(1).addClass("collapse")})}confirmModal("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",()=>delSvoc(n,s))}).on("click",".js-set-worthless",function(){const e=$(this).closest(".js-finger-detail").data("sentenceId");confirmModal('<div class="text-start row"><span class="col-12 text-center">ì™„ì „í•œ ë¬¸ì¥ì˜ êµ¬ì„±ìœ¼ë¡œ ì¶©ì¡±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— í•´ë‹¹í•©ë‹ˆë‹¤.</span><div class="mx-auto w-auto d-block"><br>\tâ€¢ ì˜¤íƒ€ê°€ í¬í•¨ëœ ë¬¸ì¥<br>\tâ€¢ ë¶ˆì™„ì „í•˜ê²Œ ì˜ë¦° ë¬¸ì¥<br>\tâ€¢ ë¬¸ì¥êµ¬ì„±ì´ ì•ˆë˜ëŠ” ë¬¸ì¥<br>\tâ€¢ ë¶ˆì™„ì „í•œ ì¸ìš©êµ¬, êµ¬ë‘ì ì˜¤ë¥˜ê°€ ìˆëŠ” ë¬¸ì¥<br>\tâ€¢ ê¸°íƒ€ ë¹„ë¬¸ì¥</div></div>',()=>{$.ajax({url:"/sentence/useful/edit",type:"POST",data:JSON.stringify({sentenceId:e,useful:!1}),contentType:"application/json",success:()=>{this.classList.remove("js-set-worthless","text-danger"),this.classList.add("text-secondary"),this.title="ìœ ìš©í•˜ì§€ ì•Šì€ ë¬¸ì¥ì…ë‹ˆë‹¤.",this.style.pointerEvent="none",alertModal("usefulê°’ì„ falseë¡œ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.")},error:()=>{alertModal("useful ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}})})}),$(".js-print-button").on("click",function(){var e=$(".workbook-title-section:eq(0)").text().trim(),t=$(".passage-title-text:eq(0)").text().trim();window._printModel={workBookTitle:e,passageTitle:t,memberAlias:f,sentenceList:S},window.open("/sample/workbook/print_passage.html")}),$("#hiddenDivs .trans-editor")),w=($(document).on("click",".js-edit-trans-open",function(){b.hide();var e=$(this).closest(".ai-translation-block");this.matches(".add-btn")?($(this).hide(),b.data("mode","add").find(".text-input").val(null),$(this).closest(devSize.isPhone()?".translation-section":".kor-list-section").find(".ai-translation-section").prepend(b)):(e.find(".trans-mdf-btns, .translation-text").hide(),b.data("mode","edit").find(".text-input").val(e.find(".translation-text").text()),e.before(b)),b.show(300)}).on("click",".js-edit-trans",function(){const e=this,n=b.next(".ai-translation-block"),t=Number($(this).closest(".one-sentence-unit-section").data("sentenceId")),s=b.find(".text-input").val().trim(),o=$(e).closest(devSize.isPhone()?".translation-section":".kor-list-section");var a={sentenceId:t,memberId:I,kor:s};"edit"==b.data("mode")&&null!=n.data("korTid")&&(a.korTid=Number(n.data("korTid"))),0!=s.length&&(e.disabled=!0,$.ajax({url:"/workbook/sentence/kor/edit",type:"POST",contentType:"application/json",data:JSON.stringify(a),success:function(e){{var t;b.hide(300,()=>b.appendTo("#hiddenDivs")),"edit"==b.data("mode")?(n.find(".translation-text").text(s).show(300),n.find(".trans-mdf-btns").show(300)):((t=O.clone()).data("korTid",e).find(".translation-text").text(s),t.addClass("user-trans"),t.find(".translator").text(" "+f),t.append($(T).find(".trans-mdf-btns").clone(!0)),o.find(".ai-translation-section").prepend(t),o.find(".add-btn").show(300),t.addClass("show"),devSize.isPhone()&&!o.find(".open-kor-btn").is(".active")&&t.siblings(".ai-translation-block").removeClass("show"))}},error:e=>{403==e.status?location.assign("/membership/expired"):alertModal("í•´ì„ ë“±ë¡/ìˆ˜ì •ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")},complete:()=>e.disabled=!1}))}).on("click",".js-edit-trans-cancel",function(){b.fadeOut(300,()=>b.appendTo("#hiddenDivs")),("edit"==b.data("mode")?b.next(".ai-translation-block").find(".trans-mdf-btns, .translation-text"):b.closest(devSize.isPhone()?".translation-section":".kor-list-section").find(".add-btn")).show(300)}).on("click",".js-del-trans",function(e){e.stopPropagation(),e.stopImmediatePropagation();const t=$(this).closest(".ai-translation-block");function n(){alertModal("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),(t.closest(".translation-section").find(".open-kor-btn").is(".active")?t.nextAll(".ai-translation-block"):t.next(".ai-translation-block"))?.collapse("show"),t.fadeOut(300,()=>t.remove())}confirmModal("ì‚­ì œí•˜ê² ìŠµë‹ˆê¹Œ?",()=>delSentenceTrans(Number(t.data("korTid")),n))}).on("click",".js-finger-detail",async function(e){if(!e.target.closest(".edit-svoc,.svoc-mdf-btns")&&e.target.closest(".js-finger-detail")){const n=$(this),s=n.find(".toggle-eye");e=n.data("sentenceId");s.is(".loading")||(s.is(".loaded")?(n.toggleClass("bg-gray-700").find(".fold-icon").toggleClass("expanded",!s.is(".active")),s.toggleClass("active disabled"),n.find(".sentence-text, .trans-block, .svoc-section").toggle(300)):(s.addClass("loading"),await $.getJSON("/workbook/sentence/finger/"+e,e=>async function(e){n.find(".sentence-text").hide();var t=$(await tandem.showSemanticAnalysis(e.eng,e.svocBytes,n.find(".svoc-section").show().find(".svoc-block")));e.svocId&&t.data("svocId",e.svocId);n.removeClass("bg-gray-700").find(".trans-block").text(e.kor).show(),n.find(".fold-icon").addClass("expanded"),s.toggleClass("disabled active loading loaded")}(e)).fail(()=>alertModal("í•´ì„Â·ë¶„ì„ ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\në‹¤ì‹œ ì ‘ì†í•´ ì£¼ì„¸ìš”."))))}}).on("click",".js-add-sentence-note-btn",function(){const e=this,t=$(this).closest(".one-sentence-unit-section");var n=Number(t.data("sentenceId"));const s=$(this).closest(".add-section");var o=s.find(".text-input").val().trim(),a=s.find(".note-open-input").val();0!=o.length&&(e.disabled=!0,$.ajax({url:"/workbook/sentence/note/add",type:"POST",contentType:"application/json",data:JSON.stringify({workbookId:C,sentenceId:n,memberId:I,content:o,noteAccess:a}),success:function(n){n.memberInfo={memberId:I,alias:f};var e=t.find(".note-section>.note-list");e.each((e,t)=>{$(t).prepend(k(n))}),s.find(".text-input").val("").summernote("destroy"),s.hide(300,function(){var e=s.closest(".note-section");e.find(".add-icon").prop("disabled",!1),e.find(".empty-list").hide()})},error:e=>{403==e.status?location.assign("/membership/expired"):alertModal("ë…¸íŠ¸ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.")},complete:()=>e.disabled=!1}))}),"#addVoca,#appendVoca,#requestVoca,#changeVoca,#addPartVoca");if($(document).on("click",".js-open-voca-form",function(){var e=$(this).closest(".one-sentence-unit-section");$("#openVocaModal").find(".original-sentence,.original-sentence-background").text(e.find(".origin-sentence .sentence-text").text()),$("#openVocaModal .voca-reg-phase").hide().eq(0).show().find('input[name="vocaTypeCheck"]').prop("checked",!1),$("#openVocaModal .trans-list").empty().append(createElement({el:"ol",children:Array.from(e.find(".translation-section:eq(0) .ai-translation-block .translation-text"),e=>({el:"li",class:"translation-text",textContent:e.textContent}))})),$("#openVocaModal").find(".text-in-sentence,.lemma").val(""),$("#openVocaModal .meaning").html('<p class="p-2">ë“±ë¡í•˜ê³ ì í•˜ëŠ” í‘œì œì–´ê°€ ê¸°ë³¸í˜•ì´ ë§ëŠ”ì§€ í™•ì¸ í›„ OKë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.</p>'),$("#openVocaModal").find(".part-type,.additional-meaning").empty().val("").prop("disabled",!0),$("#openVocaModal").data("sentenceUnit",e).modal("show"),$("#addVoca").prop("disabled",!0),y("#addVoca")}).on("change",'input[name="vocaTypeCheck"]',function(){$("#openVocaModal .original-sentence-background").text($("#openVocaModal .original-sentence").text()),$("#openVocaModal").find(".text-in-sentence,.lemma,.additional-meaning").empty().val("").removeClass("is-valid is-invalid"),$("#openVocaModal .meaning").html('<p class="p-2">ë“±ë¡í•˜ê³ ì í•˜ëŠ” í‘œì œì–´ê°€ ê¸°ë³¸í˜•ì´ ë§ëŠ”ì§€ í™•ì¸ í›„ OKë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.</p>'),$([w,".part-type,.additional-meaning"].join(",")).prop("disabled",!0),this.value?$("#openVocaModal .part-type").empty().append(`<option value="${this.value}" selected>${this.value} ${j[this.value]}</option>`):$("#openVocaModal .part-type").empty().append(createElement(Array.from(Object.entries(j).slice(0,11),([e,t])=>({el:"option",value:e,textContent:e+" "+t})))).prepend(createElement({el:"option",textContent:"ë¬¸ì¥ì—ì„œ ì“°ì¸ í’ˆì‚¬ë¥¼ ëª©ë¡ì—ì„œ ì„ íƒí•©ë‹ˆë‹¤.",selected:!0,disabled:!0,value:""})),$(this).closest(".voca-reg-phase").next(".voca-reg-phase").slideDown()}).on("mousedown","#openVocaModal .original-sentence",function(){$(this).siblings(".original-sentence-background").text(this.textContent)}),$("#openVocaModal .original-sentence").on("scroll",function(){$("#openVocaModal .original-sentence-background")[0].scrollTop=this.scrollTop}),$(document).on("mouseup","#openVocaModal .original-sentence",function(){var a=getSelection(),i=this.textContent;if(a.anchorNode.isSameNode(a.focusNode)&&"Range"==a.type&&0<a.toString().trim().length){var l,d=a.anchorNode.compareDocumentPosition(a.focusNode);let e=!1,{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:o}=((e=!d&&a.anchorOffset>a.focusOffset||d===Node.DOCUMENT_POSITION_PRECEDING?!0:e)&&a.setBaseAndExtent(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset),a);for(;/^(\s|[.,?!'"])/.test(i.substring(n));)n++;for(;/(\s|'s|[.,?!'"])$/.test(i.substring(0,o));)o--;for(;0<n&&/\w/.test(i[n-1]);)n--;for(;o<i.length&&/\w/.test(i[o]);)o++;a.setBaseAndExtent(s,o,t,n),!$('input[name="vocaTypeCheck"]:checked').val()&&a.toString().includes(" ",1)?alertModal("ê³µë°±ì„ í¬í•¨í•œ ê²½ìš°ëŠ” 'êµ¬'ë¡œ ë“±ë¡í•´ ì£¼ì„¸ìš”."):(d=[a.anchorOffset,a.focusOffset].sort((e,t)=>e-t),a=((l=$(this).closest(".voca-reg-phase").next(".voca-reg-phase").slideDown()).find(".word-start").val(d[0]),l.find(".word-end").val(d[1]),l.find(".text-in-sentence,.lemma").val(a.toString().substring(0,50)).removeClass("is-valid is-invalid"),l.find(".additional-meaning").empty().val(""),l.find(".part-type,.additional-meaning").prop("disabled",!0),l.find(".meaning").html('<p class="p-2">ë“±ë¡í•˜ê³ ì í•˜ëŠ” í‘œì œì–´ê°€ ê¸°ë³¸í˜•ì´ ë§ëŠ”ì§€ í™•ì¸ í›„ OKë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.</p>'),$(w).prop("disabled",!0),l.find(".lemma").trigger("input").focus(),$("#openVocaModal .original-sentence-background").get(0).firstChild),(l=new Range).setStart(a,d[0]),l.setEnd(a,d[1]),l.surroundContents($('<span class="bg-info"></span>').get(0)))}}).on("input","#openVocaModal .lemma",function(){var e=this.value.trim();$(this).toggleClass("is-invalid",0==e.length||50<e.length).toggleClass("is-valid",0<e.length&&e.length<=50).siblings(".uppercase-feedback").toggle(this.value.trim().toLowerCase()!=this.value.trim()),$("#openVocaModal .meaning").html('<p class="p-2">ë“±ë¡í•˜ê³ ì í•˜ëŠ” í‘œì œì–´ê°€ ê¸°ë³¸í˜•ì´ ë§ëŠ”ì§€ í™•ì¸ í›„ OKë¥¼ ëˆŒëŸ¬ ê²€ìƒ‰í•´ ì£¼ì„¸ìš”.</p>'),$("#openVocaModal .word-id").val(0),$(w).prop("disabled",!0)}).on("click","#searchVoca",function(){if($("#openVocaModal .text-in-sentence").val()){var e=$("#openVocaModal .lemma");const o=e.val().trim(),a=$('input[name="vocaTypeCheck"]:checked').val(),i="phrasal-v."==a?"pv":"np";o&&!e.is(".is-invalid")&&($("#openVocaModal .word-id").val(0),$.getJSON("/openvocas/search/word",{text:o,partType:i},t=>{$("#openVocaModal").find(".part-type,.additional-meaning").prop("disabled",!1),$(w).prop("disabled",!1);var e="pv"==i?t.find(e=>e.title==o):t[0];e&&$("#openVocaModal .word-id").val(e.wordId??0);const n=new Set,s=new Set(a?[a]:[]);t?.forEach(e=>{e?.meaningList?.forEach(e=>{e=e.match(/[^\.]+/)[0]+".";n.add(e),s.add(e)})}),a?$("#openVocaModal .part-type").empty().append(createElement(Array.from(s,(e,t)=>({el:"option",value:e,selected:0==t,textContent:e+" "+j[e],style:{background:n.has(e)?"var(--fc-yellow)":""}})))):$("#openVocaModal .part-type option").each((e,t)=>{n.has(t.value)&&(t.style.background="var(--fc-yellow)",1==n.size)&&(t.selected=!0)}),0<t?.length?(e=$("#openVocaModal").data("sentenceUnit"),a?$("#openVocaModal .meaning").empty().append($('<ul class="list-group list-group-flush"></ul>').append(createElement(Array.from(t,e=>({el:"li",class:"list-group-item",children:[{el:"span",class:"pv-title fw-bold me-5",textContent:e.title},e.meaningList.join(" ")]}))))):$("#openVocaModal .meaning").empty().append($('<ul class="list-group list-group-flush"></ul>').append(createElement(Array.from(t[0].meaningList,e=>({el:"li",class:"list-group-item",textContent:e}))))),e.find(".one-word-unit-section").get().find(e=>Array.from(t,e=>e.wordId).includes($(e).data("wordId")))?($("#appendVoca").prop("disabled",!1),y("#appendVoca")):($("#addVoca").prop("disabled",!1),y("#addVoca"))):a?($("#openVocaModal .meaning").html('<p class="p-2">ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì§€ ì•Šì€ ì–´íœ˜ì…ë‹ˆë‹¤.</p>'),$("#addVoca").prop("disabled",!1),y("#addVoca")):($("#openVocaModal .meaning").html('<p class="p-2 text-center">ì‹œìŠ¤í…œì— ë“±ë¡ë˜ì§€ ì•Šì€ ì–´íœ˜ì…ë‹ˆë‹¤.<br>ë“±ë¡ì„ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>'),$("#openVocaModal .uppercase-feedback").hide(),$(".part-type,.additional-meaning").prop("disabled",!0),$("#requestVoca").prop("disabled",!1),y("#requestVoca"))}))}else alertModal("ë¬¸ì¥ ë‚´ì—ì„œ ì–´íœ˜ë¥¼ ë¨¼ì € ë“œë˜ê·¸í•´ ì£¼ì„¸ìš”.")}).on("change","#openVocaModal .part-type",function(){var e=$("#openVocaModal").data("sentenceUnit").find(".one-word-unit-section:visible").filter((e,t)=>$(t).data("wordId")==parseInt($("#openVocaModal .word-id").val()||0));0<e.length?((e=new Set(Array.from(e.find(".part").get(),e=>e?.textContent))).has("vi.")&&e.has("vt.")&&(e.delete("vi."),e.delete("vt."),e.add("v.")),e.has(this.value)?($("#appendVoca").prop("disabled",!1),y("#appendVoca")):($("#changeVoca").text(0<$("#openVocaModal .additional-meaning").val().trim().length?"í’ˆì‚¬ ë³€ê²½ ë° ëœ» ì¶”ê°€":"í’ˆì‚¬ ë³€ê²½"),$("#changeVoca,#addPartVoca").prop("disabled",!1),y("#changeVoca,#addPartVoca"))):($("#addVoca").prop("disabled",!1),y("#addVoca"))}).on("input","#openVocaModal .additional-meaning",function(){$(w).filter((e,t)=>0==t.style.zIndex).each((e,t)=>{$(t).is("#changeVoca")&&$(t).text(0<this.value.trim().length?"í’ˆì‚¬ ë³€ê²½ ë° ëœ» ì¶”ê°€":"í’ˆì‚¬ ë³€ê²½")}),$("#addVoca,#appendVoca").prop("disabled",!this.value.trim().length&&!parseInt($("#openVocaModal .word-id").val())),$("#changeVoca,#addPartVoca").prop("disabled",!!this.value.trim().length&&!parseInt($("#openVocaModal .word-id").val()))}).on("click",w,async function(){const h=this,m=$("#openVocaModal").data("sentenceUnit"),g=parseInt($("#openVocaModal .word-id").val()),e=$('input[name="vocaTypeCheck"]:checked').val(),u=$("#openVocaModal .part-type").val(),t=$("#openVocaModal .additional-meaning").val().trim(),v=m.data("sentenceId"),n=$("#openVocaModal .lemma").val().trim(),s=$("#openVocaModal .text-in-sentence").val().trim(),o=parseInt($("#openVocaModal .word-start").val()),a=parseInt($("#openVocaModal .word-end").val()),b=$(this).is("#addVoca,#requestVoca,#addPartVoca"),w=$(this).is("#requestVoca");let i=b?"/openvocas/new/"+(e?"phrase":"word"):$(this).is("#changeVoca")?"/workbook/sentence/word/change-part":"/openvocas/append/meaning";if(!u&&0<t?.length)alertModal("í’ˆì‚¬ê°€ ì„ íƒë˜ì§€ ì•Šì€ ì¶”ê°€ì˜ë¯¸ê°€ ìˆìŠµë‹ˆë‹¤.",()=>$("#openVocaModal .part-type").focus());else if(e&&!g&&!t||!e&&g&&!u||!e&&g&&u&&!t&&0==$("#openVocaModal .meaning .list-group-item").filter((e,t)=>t.textContent.startsWith(u)).length)alertModal("ë“±ë¡ëœ ì˜ë¯¸ë“¤ ì¤‘ ì„ íƒì„ í•˜ê±°ë‚˜ ì¶”ê°€ì˜ë¯¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.");else{let e;"changeVoca"==h.id?(e={sentenceWordId:m.find(".one-word-unit-section:visible").filter((e,t)=>$(t).data("wordId")==g).data("sentenceWordId"),newPartType:u},0<t?.length&&(await $.ajax({url:i,type:"POST",data:e}),i="/openvocas/append/meaning",e={wordId:g||0,partType:u,appendMeaning:t,sentenceId:v,title:n,token:s,start:o,end:a})):e={wordId:g||0,partType:u,appendMeaning:t,sentenceId:v,title:n,token:s,start:o,end:a},h.disabled=!0,$.ajax({url:i,type:"POST",data:e,success:t=>{if(/[A-Z]|phrasal-v/.test(u)&&m.find(".word-list-section").addClass("has-user-vocas"),t&&Object.getOwnPropertyNames(t).includes("senseList")){var e=m.find(".word-section>.one-block");if(b){var n=P.clone();if(/[A-Z]|phrasal-v/.test(u)&&n.addClass("user-vocas-word"),n.data({wordId:t.wid||g,sentenceId:v,workbookId:C,sentenceWordId:t.sentenceWordId}),n.find(".one-part-unit-section").remove(),n.find(".title").text(t.title).attr("data-playing","off").click(function(e){e.stopPropagation(),"on"==this.dataset.playing?N():(N(this),this.dataset.playing="on",this.classList.add("tts-playing","blink-2"),V.speakRepeat(t.title,2,500,()=>{this.classList.remove("tts-playing","blink-2"),this.dataset.playing="off"}))}),w)n.addClass("pe-none"),n.append($('<span class="meaning fst-italic">ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ë“±ë¡ë  ì˜ˆì •ì…ë‹ˆë‹¤.<span>'));else{var s=t.senseList;0==s.length&&(p=$("#openVocaModal .meaning .list-group-item").filter((e,t)=>t.textContent.startsWith(u)).text(),s.push({partType:u,meaning:p.substring(u.length+1)}));for(const f of s){var o=f,a=q.clone();n.append(a),a.find(".part").text(o.partType).attr("title",j[o.partType]),a.find(".meaning").text(o.meaning)}}e.find(".empty-list").remove(),e.append(n)}else{var i=e.find(".one-word-unit-section").filter((e,t)=>$(t).data("wordId")==g),l=(i.find(".one-part-unit-section").remove(),t.senseList),d=l.length;for(let e=0;e<d;e++){var c=l[e],r=q.clone();i.append(r),r.find(".part").text(c.partType).attr("title",j[c.partType]),r.find(".meaning").text(c.meaning)}}alertModal(w?"ë“±ë¡ì´ ìš”ì²­ë˜ì—ˆìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ë¡œ ë“±ë¡í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.":"ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¨ì–´ëª©ë¡ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.",()=>$("#openVocaModal").modal("hide"))}else{var p;"changeVoca"==h.id?((p=m.find(".one-word-unit-section").filter((e,t)=>$(t).data("wordId")==g)).find(".one-part-unit-section").remove(),s=$("#openVocaModal .meaning .list-group-item").filter((e,t)=>t.textContent.startsWith(u)).text().substring(u.length).trim(),(e=q.clone()).find(".part").text(u).attr("title",j[u]),e.find(".meaning").text(s),p.append(e),alertModal("í’ˆì‚¬ë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤\në“±ë¡ì°½ì„ ë‹«ìŠµë‹ˆë‹¤.",()=>$("#openVocaModal").modal("hide"))):alertModal("ë“±ë¡ê²°ê³¼ë¥¼ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤\në“±ë¡ì°½ì„ ë‹«ìŠµë‹ˆë‹¤.",()=>$("#openVocaModal").modal("hide"))}},error:()=>{alertModal("ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")},complete:()=>h.disabled=!1})}}).on("click",".js-edit-note-open",async function(){var e=$(this).closest(".note-block"),t=e.find(".text-section"),n=(e.find(".note-mdf-btns").hide(),t.find(".note-text").hide());this.closest(".collapse-section")&&e.find(".note").toggleClass("overflow-hidden mb-4");e=t.find(".note-editor").show().find(".text-input").val(n.html());t.find(".open-input").trigger("input"),openSummernote(e)}).on("click",".js-edit-note-cancel",function(){var e=$(this).closest(".text-section"),t=$(this).closest(".note-block");this.closest(".collapse-section")&&$(this).closest(".note").toggleClass("overflow-hidden mb-4"),e.find(".note-editor, .note-text").add(t.find(".note-mdf-btns")).toggle()}).on("click",".js-edit-note",function(){const t=$(this).closest(".text-section"),n=$(this).closest(".note-block");var e=Number(n.data("noteId")),s=t.find(".note-open-input").val(),o=t.find(".text-input").summernote("code").trim(),e={noteId:e,workbookId:C,memberId:I,content:o},a=t.closest(".one-sentence-unit-section"),i=0<a.length?"sentence":"passage";0!=o.length&&("sentence"==i?(e.sentenceId=Number(a.data("sentenceId")),e.noteAccess=s):(e.passageId=g,e.publicOpen=JSON.parse(s)),editNote(i,e,function(e){0<n.closest(".collapse-section").length&&n.find(".note").toggleClass("overflow-hidden mb-4");t.find(".note-editor").hide(),t.find(".note-open-input").val((e.noteAccess||e.publicOpen).toString()),t.find(".note-text").html(e.content).show(),n.find(".updatedate").text((new Date).toLocaleDateString()),n.find(".note-mdf-btns, .updatedate").show()}))}).on("click",".js-delete-note",function(){const e=$(this).closest(".note-block"),t=e.closest(".note-section"),n=Number(e.data("noteId")),s=e.closest(".one-sentence-unit-section"),o=0<s.length?"sentence":"passage";function a(){e.fadeOut(function(){$(this).remove(),0==t.find(".note-block").length&&t.find(".empty-list").show()})}confirmModal("ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?",()=>{delNote(o,n,a)})}).on("click",".note-section .add-icon",async function(){$(this).prop("disabled",!0);const e=$(this).closest(".note-section");var t=e.find(".add-section");openSummernote(t.find(".text-input")),t.show(300,function(){e.find(".empty-list").hide()})}).on("click",".cancel-add-note-btn",function(){const t=$(this).closest(".add-section");var e=t.find(".text-input").val("");"function"==typeof e.summernote&&e.summernote("destroy"),t.hide(300,function(){var e=t.closest(".note-section");e.find(".add-icon").prop("disabled",!1),0==e.find(".note-list .note-block").length&&e.find(".empty-list").show()})}).on("click",".js-request-note",function(){const e=this;var t=$(this).closest(".one-sentence-unit-section");const n=t.find(".origin-sentence .sentence-text").text().trim(),s=t.data("sentenceId");confirmModal('<img class="align-baseline" src="https://static.findsvoc.com/images/icons/ssamnote.png" style="width: 5rem;">ë¥¼ ì‹ ì²­í•˜ì‹œê² ìŠµë‹ˆê¹Œ?',function(){e.disabled=!0,$.ajax({url:"/workbook/ssamnote/request",type:"POST",data:{workbookId:C,passageId:g,sentenceId:s,eng:n},success:function(e){e?alertModal(e):alertModal("ì •ìƒì ìœ¼ë¡œ ì‹ ì²­ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nì‹ ì²­í•˜ì‹  ë…¸íŠ¸ëŠ” 09:00~18:00 ì‚¬ì´ ì²˜ë¦¬ë©ë‹ˆë‹¤.\n(ë‹¹ì¼ ì²˜ë¦¬ë˜ì§€ ëª» í•œ ë…¸íŠ¸ëŠ” ë‹¤ìŒ ì˜ì—…ì¼ì— ì²˜ë¦¬ë©ë‹ˆë‹¤.)")},error:function(){alertModal("ì‹ ì²­ì´ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ëª» í–ˆìŠµë‹ˆë‹¤.")},complete:()=>e.disabled=!1})})}).on("show.bs.collapse",".craft-section",function(){var e=$(this).closest(".one-sentence-unit-section"),t=(e.find(".dashboard-section").collapse("hide"),Array.from(e.find(".ai-translation-section").eq(0).find(".ai-translation-block"),e=>({id:$(e).data("korTid"),text:e.querySelector(".translation-text").textContent})));null==this.querySelector(".battle-section-panel")&&craft.openBattleMakerPanel(this,I,M,e.data("sentenceId"),e.find(".semantics-result")[0],t)}),["A","S"].includes(M)){const x=".one-word-unit-section",A={el:"span",role:"button",class:"js-del-word fas fa-trash-alt",dataset:{bsToggle:"tooltip",bsTitle:"ì‚­ì œ"}};$(document).on("mouseover",x,function(){var e,t;0<$(this).find(".js-del-word").length||(e=createElement(A),t=$(this).find(".title"),$(e).insertAfter(t))}).on("mouseleave",x,function(){$(this).find(".js-del-word").remove()}).on("click",".js-del-word",function(e){e.stopPropagation();const t=$(this).closest(x),n=t.data()["sentenceWordId"];e=t.find(".title").text().trim();confirmModal(`ì´ ë¬¸ì¥ì—ì„œ ë‹¨ì–´ ${e}ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`,()=>{$.ajax({url:"/workbook/sentence/word/del",type:"POST",contentType:"application/json",data:JSON.stringify(n),success:()=>{alertModal("ë‹¨ì–´ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.",()=>{var e=t.closest(".word-list-section");e.toggleClass("has-user-vocas",e.find(".part").get().some(e=>/[A-Z]|phrasal-v/.test(e.textContent))),t.slideUp(()=>t.remove())})},error:e=>{alertModal(e.responseText)}})})})}function k(e){var t,n=$(T).children(`.note-block.${e?.hasOwnProperty("sentenceId")?"sentence":"passage"}-note`).clone(!0)[0];return devSize.isPhone()&&n.querySelector(".note").classList.add("overflow-hidden"),n.dataset.noteId=e.noteId,n.querySelector(".note-text").innerHTML=e.content,n.querySelector(".updatedate").textContent=new Date(e.updateDate||new Date).toLocaleDateString(),I!=e?.memberInfo?.memberId?n.querySelector(".note-mdf-btns").remove():((t=$(n).find(".note-editor .note-open-input")).val((e.noteAccess??e.publicOpen).toString()),t.trigger("input")),n.querySelector(".personacon-section .alias").textContent=e?.memberInfo?.alias,$(n)}function L(e){switch(e){case"S":return{icon:"ğŸ¥³",msg:"í‰ê°€ë¥¼ ë°›ì€ ë¬¸ì¥ì´ì˜ˆìš”."};case"F":return{icon:"ğŸ¤¯",msg:"ë¶„ì„ì´ í‹€ë ¸ëŒ€ìš”."};default:return{icon:"ğŸ¤”",msg:"ì•„ì§ í‰ê°€ë˜ì§€ ì•Šì€ ë¬¸ì¥ì´ì˜ˆìš”."}}}function y(n){anime({targets:$(w).get(),rotateX:e=>e.matches(n)?"0deg":"180deg",duration:400,easing:"linear",update:e=>{50<e.progress&&e.animatables.forEach(e=>{var t=e.target.matches(n);e.target.style.zIndex=t?0:-1,e.target.disabled=!t})}})}}